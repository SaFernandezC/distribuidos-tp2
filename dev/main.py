from common.Connection import Connection
import ujson as json


def main():
    """
        Replico el distance calculator
    """

    connection = Connection()
    output_queue = connection.Producer("groupby_query_3")

    data = [{'end_name': 'Garnier / du Mont-Royal', 'distance': 3.234834745886383},
        {'end_name': "du Mont-Royal / Vincent-d'Indy", 'distance': 2.773750780797887}]
        # ,{'end_name': 'Parc J.-Arthur-Champagne (Chambly / du Mont-Royal)', 'distance': 5.428756927149416},
        # {'end_name': 'Métro St-Laurent (de Maisonneuve / St-Laurent)', 'distance': 3.693825518180712},
        # {'end_name': 'de Maisonneuve / de Bleury', 'distance': 0.7482388470774167}, {'end_name': 'Calixa-Lavallée / Rachel', 'distance': 3.0046782777753394}, {'end_name': 'Guy / Notre-Dame', 'distance': 0.0}, {'end_name': 'Square St-Louis', 'distance': 2.893135921858366}, {'end_name': 'Queen / Wellington', 'distance': 1.4980484292529903}, {'end_name': 'Roy / St-Christophe', 'distance': 0.5058184641584527}, {'end_name': 'Milton / du Parc', 'distance': 2.0016174925616053}, {'end_name': 'Ste-Famille / Sherbrooke', 'distance': 0.9193218546043495}, {'end_name': 'Square St-Louis', 'distance': 0.47285906708868325}, {'end_name': 'LaSalle / Sénécal', 'distance': 2.1360115120108554}, {'end_name': 'Clark / Prince-Arthur', 'distance': 0.36321772602735125}, {'end_name': 'de la Commune / Place Jacques-Cartier', 'distance': 0.3980696161485635}, {'end_name': 'Prince-Arthur / du Parc', 'distance': 1.008723122155392}, {'end_name': 'Guy / Notre-Dame', 'distance': 1.353086897876073}, {'end_name': 'Métro Joliette  (Joliette / Hochelaga)', 'distance': 2.479574692582068}, {'end_name': 'de la Salle / Ste-Catherine', 'distance': 3.312979858260176}, {'end_name': 'Chambord / Laurier', 'distance': 1.6692202839311556}, {'end_name': 'St-Mathieu /Ste-Catherine', 'distance': 2.841730945908678}, {'end_name': 'Chomedey / de Maisonneuve', 'distance': 0.7701351187671318}, {'end_name': 'Métro Papineau (Cartier / Ste-Catherine)', 'distance': 2.4095456031427926}, {'end_name': 'Boyer / Beaubien', 'distance': 2.101110325354512}, {'end_name': 'Plessis / Ontario', 'distance': 1.9439470141925077}, {'end_name': 'Gascon / Rachel', 'distance': 0.869416387630678}, {'end_name': 'Gilford / Brébeuf', 'distance': 1.2884094110070048}, {'end_name': "Métro Place-d'Armes (Viger / St-Urbain)", 'distance': 5.659284192597216}, {'end_name': 'Mackay /de Maisonneuve (Sud)', 'distance': 3.299072124044036}, {'end_name': 'de la Commune / Berri', 'distance': 5.178857114254635}, {'end_name': 'de la Salle / Ste-Catherine', 'distance': 4.388739034411897}, {'end_name': 'Marquette / du Mont-Royal', 'distance': 1.945884036764351}, {'end_name': 'Duvernay / Charlevoix', 'distance': 0.7577894970410548}, {'end_name': 'Lajeunesse / Jarry', 'distance': 6.771076312542658}, {'end_name': 'Ste-Catherine / St-Denis', 'distance': 0.1945378582518371}, {'end_name': 'Berri / Cherrier', 'distance': 0.5497748482236401}, {'end_name': 'Towers / Ste-Catherine', 'distance': 1.2606965631824834}, {'end_name': 'Marie-Anne / de la Roche', 'distance': 1.5769921735420085}, {'end_name': 'Guizot / St-Denis', 'distance': 0.7688999256382284}, {'end_name': 'Milton / Université', 'distance': 5.116742850451071}, {'end_name': 'De La Roche / Everett', 'distance': 5.312385254507891}, {'end_name': 'de St-Vallier / Rosemont', 'distance': 1.1739624741987364}, {'end_name': 'Gauthier / Papineau', 'distance': 2.735336206508815}, {'end_name': 'St-Cuthbert / St-Urbain', 'distance': 1.4625579175208807}, {'end_name': 'Francis / Fleury', 'distance': 7.181235928022996}, {'end_name': 'Sanguinet / de Maisonneuve', 'distance': 1.1004522632937965}, {'end_name': 'St-Dominique / Villeray', 'distance': 1.6217355374638214}, {'end_name': 'de Gaspé / Jarry', 'distance': 4.172910672620727}, {'end_name': 'Milton / Clark', 'distance': 1.6973683350086375}, {'end_name': 'Sanguinet / Ste-Catherine', 'distance': 0.3986558955800874}, {'end_name': 'Bourbonnière / du Mont-Royal', 'distance': 1.380386824168438}, {'end_name': 'Métro Mont-Royal (Rivard / du Mont-Royal)', 'distance': 1.1407150779930326}, {'end_name': 'Chapleau / du Mont-Royal', 'distance': 0.5982826650599714}, {'end_name': 'Bishop / de Maisonneuve', 'distance': 0.8280831809493391}, {'end_name': 'Métro Mont-Royal (Rivard / du Mont-Royal)', 'distance': 1.6401546276913685}, {'end_name': '10e avenue / Masson', 'distance': 1.7817389944109117}, {'end_name': 'Marquette / Rachel', 'distance': 1.9348791965944299}, {'end_name': 'Tupper / Atwater', 'distance': 4.195084174966426}, {'end_name': 'Métro Charlevoix (Centre / Charlevoix)', 'distance': 0.4810298488141816}, {'end_name': 'de Maisonneuve / Aylmer', 'distance': 3.593353148947589}, {'end_name': 'Chambly / Rachel', 'distance': 0.591880946109772}, {'end_name': 'Viger/Jeanne Mance', 'distance': 2.765681867213931}, {'end_name': 'Cartier / Marie-Anne', 'distance': 1.1180564328579083}, {'end_name': 'Jeanne Mance / du Mont-Royal', 'distance': 1.3591731246887908}, {'end_name': 'Bernard / Clark', 'distance': 2.874076412718064}, {'end_name': 'St-Jacques / Gauvin', 'distance': 0.7188802521849901}, {'end_name': 'Duluth / St-Denis', 'distance': 3.9052925494514223}, {'end_name': 'St-Dominique / Jean-Talon', 'distance': 0.0}, {'end_name': 'Viger/Jeanne Mance', 'distance': 0.8556312070659083}, {'end_name': 'Towers / Ste-Catherine', 'distance': 1.2820621503578318}, {'end_name': 'Métro Charlevoix (Centre / Charlevoix)', 'distance': 2.9765578985821537}, {'end_name': 'de Lanaudière / Gilford', 'distance': 0.9521642491946839}, {'end_name': 'Terrasse Mercure / Fullum', 'distance': 3.1823532654957867}, {'end_name': 'Laval / Duluth', 'distance': 1.5594453474084657}, {'end_name': 'Président-Kennedy / McGill College', 'distance': 0.7796971333117961}, {'end_name': 'de Darlington / de la Côte-Ste-Catherine', 'distance': 0.5897577782514495}, {'end_name': 'Peel / avenue des Canadiens de Montréal', 'distance': 1.4020348469807646}, {'end_name': 'St-Dominique / St-Zotique', 'distance': 0.16358882721486623}, {'end_name': 'Mentana / Marie-Anne', 'distance': 0.0}, {'end_name': 'Marquette / du Mont-Royal', 'distance': 2.1975686794857383}, {'end_name': 'René-Lévesque / Papineau', 'distance': 1.6900566044648906}, {'end_name': 'Milton / Durocher', 'distance': 1.7989058252927979}, {'end_name': 'de Maisonneuve / Greene', 'distance': 1.3582327719951934}, {'end_name': 'Duluth / St-Denis', 'distance': 0.6829060688104329}, {'end_name': 'De la Commune / King', 'distance': 0.8852024095638285}, {'end_name': 'Cypress / Peel', 'distance': 0.5684685015551104}, {'end_name': 'Garnier / du Mont-Royal', 'distance': 0.8290719090745229}, {'end_name': 'Pontiac / Gilford', 'distance': 1.4969953198890797}, {'end_name': 'Chomedey / de Maisonneuve', 'distance': 4.026737914504773}, {'end_name': 'Chambord / Bélanger', 'distance': 0.7116451880567007}, {'end_name': 'Métro Papineau (Cartier / Ste-Catherine)', 'distance': 3.7022131296071383}, {'end_name': 'Métro Jean-Drapeau', 'distance': 0.882656674505241}, {'end_name': 'Jacques-Cassault / Christophe-Colomb', 'distance': 3.6665479912325916}, {'end_name': 'Roy / St-Laurent', 'distance': 0.4204350265380584}, {'end_name': 'Gauthier / Papineau', 'distance': 2.1377511533106213}, {'end_name': "Ross / de l'Église", 'distance': 2.086512370140366}, {'end_name': 'St-Mathieu /Ste-Catherine', 'distance': 1.6308822263154372}, {'end_name': 'Viger/Jeanne Mance', 'distance': 1.6376446576315726}, {'end_name': 'Clark / St-Viateur', 'distance': 1.1673334878569002}, {'end_name': 'Place de la paix ( Pl. du marché / St-Dominique )', 'distance': 1.9545904570178683}, {'end_name': 'Dandurand / Papineau', 'distance': 1.3752816076940322}, {'end_name': 'Bernard / Jeanne-Mance', 'distance': 0.8955521116654042}, {'end_name': '10e avenue / Masson', 'distance': 0.40744498609148366}, {'end_name': 'de Gaspé / Fairmount', 'distance': 1.0623622755195274}, {'end_name': 'Bishop / Ste-Catherine', 'distance': 1.371880088509267}, {'end_name': 'Métro George-Vanier (St-Antoine / Canning)', 'distance': 1.8726442220340611}, {'end_name': 'Sanguinet / Ontario', 'distance': 2.1404359323649067}, {'end_name': 'Métro Jean-Drapeau', 'distance': 1.65093212012679}, {'end_name': 'Hamel / Sauvé', 'distance': 2.4574145210374274}, {'end_name': "Lucien L'Allier / St-Jacques", 'distance': 0.41863598300991883}, {'end_name': 'St-Urbain / René-Lévesque', 'distance': 1.0357689729753616}, {'end_name': 'de Maisonneuve / de Bleury', 'distance': 0.6139867381965004}, {'end_name': 'de St-Vallier / Rosemont', 'distance': 3.404967340109238}, {'end_name': 'du Parc-La Fontaine / Roy', 'distance': 0.9920824577286829}, {'end_name': 'Towers / Ste-Catherine', 'distance': 4.445843630590682}, {'end_name': 'de Gaspé / de Liège', 'distance': 6.150498953013399}, {'end_name': 'Prince-Arthur / du Parc', 'distance': 5.790887174284552}, {'end_name': 'Square Phillips', 'distance': 0.4410039590030496}, {'end_name': 'Henri-Julien / Jean-Talon', 'distance': 0.7213450830183374}, {'end_name': "de l'Esplanade / Laurier", 'distance': 2.5335795064197524}, {'end_name': 'Ontario / du Havre', 'distance': 1.5142902817434212}, {'end_name': "de l'Hôtel-de-Ville / Roy", 'distance': 0.9673046339986667}, {'end_name': 'Complexe sportif Claude-Robillard (Émile-Journault)', 'distance': 2.4967919340249805}, {'end_name': 'Métro Laurier (Rivard / Laurier)', 'distance': 2.3235016312673396}, {'end_name': 'Mackay /de Maisonneuve (Sud)', 'distance': 0.9494332747048071}, {'end_name': 'du Mont-Royal / du Parc', 'distance': 0.9901859148404143}, {'end_name': 'Marquette / du Mont-Royal', 'distance': 2.046536043364117}, {'end_name': 'du Mont-Royal / Clark', 'distance': 0.6743200965300717}, {'end_name': 'Clark / Prince-Arthur', 'distance': 1.2762414390072443}, {'end_name': "de l'Esplanade / Laurier", 'distance': 0.6465614935923089}, {'end_name': 'Alexandra / Waverly', 'distance': 1.3158267151977936}, {'end_name': 'Laurier / 15e avenue', 'distance': 0.853419117563385}, {'end_name': 'Milton / Université', 'distance': 1.1633467197105996}, {'end_name': 'Queen / Ottawa', 'distance': 6.949863316354289}, {'end_name': 'Berri / de Maisonneuve', 'distance': 2.3897551368855985}, {'end_name': 'Métro Jean-Drapeau', 'distance': 0.0}, {'end_name': 'Métro Mont-Royal (Rivard / du Mont-Royal)', 'distance': 1.0119881646717324}, {'end_name': 'Villeneuve / St-Urbain', 'distance': 2.8579922064157186}, {'end_name': 'Ste-Catherine / St-Hubert', 'distance': 2.3680854666256024},
        # {'end_name': '1ère avenue / Rosemont', 'distance': 2.6019005988650266},
        # {'end_name': "de l'Esplanade / Fairmount", 'distance': 0.7029540246358286}, {'end_name': 'Calixa-Lavallée / Rachel', 'distance': 0.9923462918846127}, {'end_name': '30e avenue / St-Zotique', 'distance': 2.3399461424422103}, {'end_name': 'de Maisonneuve / de Bleury', 'distance': 1.374930069204561}, {'end_name': 'Notre-Dame / Peel', 'distance': 1.2085914958034796}, {'end_name': 'Chomedey / de Maisonneuve', 'distance': 3.3718788578384307}, {'end_name': 'de la Commune / Berri', 'distance': 1.322128468152476}, {'end_name': "de l'Hôtel-de-Ville / Sherbrooke", 'distance': 1.7931982762857035}, {'end_name': 'Jeanne Mance / du Mont-Royal', 'distance': 0.6633483870202618}, {'end_name': 'Berri / Cherrier', 'distance': 1.4612670507401517}, {'end_name': 'Hôtel-de-Ville (du Champs-de-Mars / Gosford)', 'distance': 0.8503001763855995}, {'end_name': 'Duluth / St-Denis', 'distance': 1.4267256242876427}, {'end_name': 'Resther / du Mont-Royal', 'distance': 1.16222576917198}, {'end_name': 'Pierre-de-Coubertin / Aird', 'distance': 4.635790172388333}, {'end_name': 'Berri / Cherrier', 'distance': 0.9742511640203213}, {'end_name': 'Benny / Monkland', 'distance': 1.3913336738552904}, {'end_name': 'Boyer / du Mont-Royal', 'distance': 1.4232742029074665}, {'end_name': 'de Maisonneuve / Stanley', 'distance': 3.031032654631307}, {'end_name': 'Roy / St-Denis', 'distance': 4.3742069684610305}, {'end_name': 'St-Denis / de Maisonneuve', 'distance': 0.3579836544955502}, {'end_name': 'Gilford / Brébeuf', 'distance': 3.573911644522163}, {'end_name': 'Henri-Julien / Jean-Talon', 'distance': 2.8989908391180492}, {'end_name': 'Milton / Clark', 'distance': 0.8093721221868675}, {'end_name': 'Square St-Louis', 'distance': 0.6691273066737928}, {'end_name': 'Chambly / Rachel', 'distance': 1.3715152425488413}, {'end_name': 'Marquette / du Mont-Royal', 'distance': 0.919938930042653}, {'end_name': 'Berri / de Maisonneuve', 'distance': 0.8674274950951724}, {'end_name': 'Omer-Lavallée / Midway', 'distance': 2.0039244550831437}, {'end_name': 'Parc Père-Marquette (Chambord / Rosemont)', 'distance': 2.9041436993778404}, {'end_name': 'Louis Hémon / Rosemont', 'distance': 2.654662877400547}, {'end_name': 'de Bordeaux / Beaubien', 'distance': 2.589888311903856}, {'end_name': 'Gounod / St-Denis', 'distance': 0.9925266366112194}, {'end_name': 'de Châteaubriand / Beaubien', 'distance': 2.600883313315848}, {'end_name': 'Milton / Clark', 'distance': 0.6122516486245253}, {'end_name': 'Valois / Ontario', 'distance': 0.7444660277246401}, {'end_name': 'Duvernay / Charlevoix', 'distance': 1.2514620631765947}, {'end_name': 'Louis-Hébert / Beaubien', 'distance': 1.4612089343766204}, {'end_name': 'Métro Joliette  (Joliette / Hochelaga)', 'distance': 1.3742427069933396}, {'end_name': 'St-Dominique / Rachel', 'distance': 0.9108955449497784}, {'end_name': 'Garnier / St-Joseph', 'distance': 3.856938214367774}, {'end_name': 'Roy / St-Christophe', 'distance': 5.546389152492696}, {'end_name': 'Laval / Duluth', 'distance': 0.6120040973541641}, {'end_name': 'de la Commune / Berri', 'distance': 1.371757425214145}, {'end_name': 'Fleury / Lajeunesse', 'distance': 0.5201743991881045}, {'end_name': 'Hôtel-de-Ville 2 (du Champs-de-Mars / Gosford)', 'distance': 1.9557666330195038}, {'end_name': 'Wolfe / Robin', 'distance': 0.6564855503945639}, {'end_name': 'Berri / St-Grégoire', 'distance': 1.5992489300259134}, {'end_name': 'St-André / Cherrier', 'distance': 1.687231633613463}, {'end_name': 'Émile-Duployé / Sherbrooke', 'distance': 1.8071704881491448}, {'end_name': 'Dézéry / Ontario', 'distance': 0.9360802675722532},
        # {'end_name': 'Hutchison/ Prince-Arthur', 'distance': 5.009787458964661}, {'end_name': 'Métro Charlevoix (Centre / Charlevoix)', 'distance': 7.1966309704811415}, {'end_name': 'Marquette / du Mont-Royal', 'distance': 1.886982840094644}, {'end_name': 'de Bullion / St-Joseph', 'distance': 1.1491269654909573}, {'end_name': 'Métro Lionel-Groulx (Lionel-Groulx / Charlevoix)', 'distance': 1.404513364563505}, {'end_name': "Métro Lucien-L'Allier  (Lucien l'Allier / Argyle)", 'distance': 1.0609957670823342}, {'end_name': 'de la Commune / Place Jacques-Cartier', 'distance': 1.8043118723157747}, {'end_name': 'Drolet / Beaubien', 'distance': 0.8448342276659534}, {'end_name': 'Marie-Anne / de la Roche', 'distance': 0.7429224496634808}]


    while True:
        print("1 - Send msg \n 2 - Send eof")
        user_inp = int(input())
        if user_inp == 1:
            output_queue.send(json.dumps({"client_id": 2, "data": data}))
        else:
            output_queue.send(json.dumps({"client_id": 2, "eof": True}))

    return 0


if __name__ == "__main__":
    main()
